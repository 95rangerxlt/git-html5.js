<html>
<head>


<script type="text/javascript" src="FauxFilesystem.js"></script>
<script type="text/javascript" src="rawdeflate.js"></script>
<script type="text/javascript" src="rawinflate.js"></script>
<script type="text/javascript" src="jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="git/crc32.js"></script>
<script type="text/javascript" src="git/git.js"></script>
<script type="text/javascript" src="git/binary_file.js"></script>
<script type="text/javascript" src="git/string_helpers.js"></script>
<script type="text/javascript" src="git/upload_pack_parser.js"></script>
<script type="text/javascript" src="git/pack.js"></script>
<script type="text/javascript" src="git/memory_repo.js"></script>
<script type="text/javascript" src="git/remote.js"></script>
<script type="text/javascript" src="git/http_remote.js"></script>
<script type="text/javascript" src="git/smart_http_remote.js"></script>
<script type="text/javascript" src="git/objects.js"></script>
<script type="text/javascript" src="git/diff3.js"></script>
<script type="text/javascript" src="git/delta.js"></script>
<script type="text/javascript" src="git/underscore-min.js"></script>
<script type="text/javascript" src="2.2.0-sha1.js"></script>
<script type="text/javascript" src="gito.js"></script>
<script type="text/javascript" src="git/pack_index.js"></script>
<script type="text/javascript" src="file_utils.js"></script>
<script type="text/javascript" src="git/file_repo.js"></script>
<script>
var repo;
var uri = 'https://github.com/ryanackley/GitTest1.git';
jQuery.ajaxSetup({
        xhr: function(){
            var xhr = new XMLHttpRequest();
           
            return xhr;
        }
    });
function launchTest(){
	window.requestFileSystem('','', function(dirEntry){
		dirEntry.getDirectory('testDir', {}, function(testDir){
			repo = new Git.FileRepo(testDir);
			repo.clone(uri, function(){});
		});
	});
	//debugger  ;
	//repo.addRemote("origin", uri);
    //  var origin = repo.getRemote("origin")
    //  origin.fetchRefs(function(refs) {
      
        //var x = 0;
       // window.setTimeout(function(){
     //   	origin.fetchRef(refs.slice(1));
        //}, 0);
      //});
	/*window.requestFileSystem('','', function(dirEntry){
		dirEntry.getDirectory('testDir', {}, function(testDir){
			Gito.init(testDir);
            Gito.commit(testDir, function(sha){
            	testDir.getFile('.git/refs/heads/master', {}, function(fileEntry){
            		fileEntry.createWriter(function(writer){
            			var bb = new BlobBuilder();
            			bb.append(sha);
            			writer.write(bb.getBlob());
            		});
            	});
            });
		});
	});*/
}
function doCommit(){
	if (!repo){
		window.requestFileSystem('','', function(dirEntry){
			dirEntry.getDirectory('testDir', {}, function(testDir){
				repo = new Git.FileRepo(testDir);
				repo.commit(function(sha){
					var x = 0;
				});
			});
		});
	}
	else
	{
		repo.commit(function(sha){
					var x = 0;
				});
	}
	//});
}
function doPush(){
	if (!repo){
		window.requestFileSystem('','', function(dirEntry){
			dirEntry.getDirectory('testDir', {}, function(testDir){
				repo = new Git.FileRepo(testDir);
				repo.load(function(){
					repo.push(uri, function(){
					});
				});
			});
		});
	}
	else{
		repo.push(uri, function(){
		});
	}
}

function doPull(){
	if (!repo){
		window.requestFileSystem('','', function(dirEntry){
			dirEntry.getDirectory('testDir', {}, function(testDir){
				repo = new Git.FileRepo(testDir);
				repo.load(function(){
					repo.pull(uri, function(){
					},
					function(e){
					});
				});
			});
		});
	}
	else{
		repo.pull(uri, function(){
		});
	}
}
</script>
</head>
<body>
<input type="button" name="Test" value="test" onclick="launchTest();"/>
<input type="button" name="Commit" value="commit" onclick="doCommit();"/>
<input type="button" name="Push" value="push" onclick="doPush();"/>
<input type="button" name="Pull" value="pull" onclick="doPull();"/>
</body>
</html